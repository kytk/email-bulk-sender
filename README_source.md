# メール一括送信ツール

メールを一斉送信すると、迷惑メールとして扱われてしまったり、他の受信者のメールアドレスが見えてしまうなどのリスクがあります。このツールを使うことで、受信者リストに基づいて個々のメールアドレスに個別のメールを一括送信できます。

GUI版とCLI版の両方が含まれています。

## インストール

### 必要な環境

- Python 3.6以上
- インターネット接続

### セットアップ

```bash
pip install -r requirements.txt
```

### ファイル構成

| ファイル | 説明 |
|---------|------|
| `email_bulk_sender_gui.py` | GUI版 |
| `email_bulk_sender.py` | CLI版 |
| `requirements.txt` | 依存パッケージ |
| `examples/` | 受信者リストとテンプレートのサンプル |
| `README_source.md` | このファイル |

## 使い方（GUI版）

### 起動

```bash
python email_bulk_sender_gui.py
```

### 画面構成

画面は以下のセクションで構成されています。

#### SMTP設定

メール送信に使用するSMTPサーバーとポート番号を設定します。

主要なメールサービスの設定値：

| サービス | SMTPサーバー | ポート |
|---------|-------------|-------|
| Gmail | smtp.gmail.com | 587 |
| Outlook/Office365 | smtp.office365.com | 587 |
| Yahoo Mail | smtp.mail.yahoo.com | 587 |
| iCloud | smtp.mail.me.com | 587 |

**注意：** Gmailを使用する場合は[アプリパスワード](https://support.google.com/accounts/answer/185833)の取得が必要です。

#### 送信元設定

- **メールアドレス** - 送信に使用するメールアドレス
- **パスワード** - メールアカウントのパスワード（またはアプリパスワード）
- **表示名** - 受信者に表示される送信者名（例：「○○大学 △△研究室」）

#### ファイル設定

- **受信者リスト** - 送信先の一覧ファイル（CSV または Excel）を「参照」ボタンで選択
- **テンプレート** - メールの件名と本文を記載したテキストファイルを「参照」ボタンで選択
- **添付ファイル** - 添付したいファイルを「参照」ボタンで選択（複数選択可）

#### メールオプション

- **CC** - CCに追加するメールアドレス（複数の場合はカンマ区切り）
- **BCC** - BCCに追加するメールアドレス（複数の場合はカンマ区切り）
- **Reply-To** - 返信先メールアドレス（送信元と異なる場合）
- **送信間隔** - メール送信の間隔（秒）。大量送信時はスパム対策として長めに設定してください

#### ツールバーのボタン

- **設定を保存** - 現在の設定をファイルに保存します。パスワードはOSの安全な保存領域に保存されます
- **設定を読み込み** - 保存した設定を読み込みます。起動時にも自動的に読み込まれます

#### 操作ボタン

- **受信者リスト確認** - 読み込んだ受信者リストの内容を一覧表示します
- **プレビュー** - 1件目の受信者データで実際のメール内容を確認できます
- **テスト送信** - 指定したメールアドレスに1通だけテスト送信します。本番前に必ずテスト送信で内容を確認してください
- **送信開始** - 全受信者へのメール送信を開始します。進捗バーとログで状況を確認できます
- **キャンセル** - 送信中に中断できます

#### 言語

画面右上の「JA / EN」で日本語・英語を切り替えできます。

## 使い方（CLI版）

CLI版はターミナル上で対話形式でメールを送信します。

### 基本的な実行

```bash
# 日本語で実行（デフォルト、システム言語を自動検出）
python email_bulk_sender.py

# 英語で実行
python email_bulk_sender.py --lang en
```

### 設定ファイルの利用

```bash
# 設定をファイルに保存して実行
python email_bulk_sender.py --save-config

# 保存した設定を読み込んで実行
python email_bulk_sender.py --load-config
```

設定ファイルは `~/.email_bulk_sender/config.json` に保存されます。

## 受信者リスト

受信者リストは CSV（.csv）または Excel（.xlsx）ファイルで作成します。

**必要な列：**

| 所属 | 氏名 | メールアドレス |
|------|------|----------------|
| 株式会社サンプル | 山田太郎 | yamada@example.com |
| XYZ商事株式会社 | 佐藤花子 | sato@example.com |

- 1行目はヘッダー行（`所属,氏名,メールアドレス`）
- 英語ヘッダー（`affiliation,name,email`）も使用可能
- CSVファイルの文字コードは UTF-8 推奨（Shift_JIS も自動検出されます）
- Excel ファイルを使用すると文字コードの問題を回避できます

サンプルファイル：`examples/list_sample.csv`、`examples/list_sample.xlsx`

## テンプレート

メールの件名と本文を1つのテキストファイルで管理します。

**ルール：**

- **1行目** - 件名
- **2行目** - 空行（必須）
- **3行目以降** - 本文

**例：**

```
ご案内 - {所属} {氏名}様

{所属}
{氏名}様

いつもお世話になっております。
（本文をここに記載します）
```

**プレースホルダー：**

テンプレート内の以下の文字列が、受信者リストの情報に自動的に置換されます。

- `{所属}` → 受信者リストの「所属」列の値
- `{氏名}` → 受信者リストの「氏名」列の値

サンプルファイル：`examples/body_sample.txt`（Windows用：`examples/body_sample_win.txt`）

## サポート

問題や質問がある場合は、[GitHub Issue](https://github.com/kytk/email-bulk-sender/issues) で報告してください。
